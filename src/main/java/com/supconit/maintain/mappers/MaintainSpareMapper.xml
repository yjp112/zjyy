<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://hc.supconit.com/mybatis-3-mapper.dtd">

<mapper namespace="com.supconit.maintain.entities.MaintainSpare">
	<resultMap type="com.supconit.maintain.entities.MaintainSpare" id="maintainSpareResultMap">      
        <result property="id" column="ID" />
		<result property="maintainCode" column="MAINTAIN_CODE" />
		<result property="spareId" column="SPARE_ID"/>
		<result property="spareCode" column="SPARE_CODE"/>
		<result property="spareName" column="SPARE_NAME"/>
		<result property="spareSpec" column="SPARE_SPEC"/>
		<result property="qty" column="QTY"/>
		<result property="money" column="MONEY"/>
		<result property="remark" column="REMARK"/>
	</resultMap>
	
	<sql id="TABLE_NAME" lang="velocity">MAINTAIN_SPARE</sql>
	
	<select id="selectMaintainSpareList" parameterType="string" resultMap="maintainSpareResultMap" lang="velocity">
		SELECT
			a.ID,
			a.MAINTAIN_CODE,
			a.SPARE_ID,
			a.SPARE_CODE,
			a.SPARE_NAME,
			a.SPARE_SPEC,
			a.QTY,
			a.MONEY,
			a.REMARK
		FROM <include refid="TABLE_NAME"/> a
		WHERE a.MAINTAIN_CODE =  @{_parameter.maintainCode,jdbcType=VARCHAR}
	</select>
	
	<delete id="deleteByMaintainCode" parameterType="string" lang="velocity"> 
		DELETE FROM <include refid="TABLE_NAME"/> WHERE MAINTAIN_CODE =  @{_parameter.maintainCode,jdbcType=VARCHAR}
	</delete>
    
	<insert id="batchInsert" databaseId="oracle">
       INSERT ALL 
        <foreach collection="maintainSpareList"  separator=" " item="spare">
            INTO <include refid="TABLE_NAME"/>(
        	ID,
            MAINTAIN_CODE,
            SPARE_ID,
            SPARE_CODE,
            SPARE_NAME,
            SPARE_SPEC,
            QTY,
            MONEY,
            REMARK
	        ) VALUES
            (
            func_getseqval('SEQ_MAINTAIN_SPARE'),
            #{maintainCode,jdbcType=VARCHAR},
            #{spare.spareId,jdbcType=NUMERIC},
            #{spare.spareCode,jdbcType=VARCHAR},
            #{spare.spareName,jdbcType=VARCHAR},
            #{spare.spareSpec,jdbcType=VARCHAR},
            #{spare.qty,jdbcType=NUMERIC},
            #{spare.money,jdbcType=NUMERIC},
            #{spare.remark,jdbcType=VARCHAR}
            )
        </foreach>
        SELECT * FROM dual
    </insert>


    <insert id="batchInsert" databaseId="sqlserver">
       INSERT INTO <include refid="TABLE_NAME"/>(
            MAINTAIN_CODE,
            SPARE_ID,
            SPARE_CODE,
            SPARE_NAME,
            SPARE_SPEC,
            QTY,
            MONEY,
            REMARK
	    ) VALUES
        <foreach collection="maintainSpareList"  separator="," item="spare">
            (
            #{maintainCode,jdbcType=VARCHAR},
            #{spare.spareId,jdbcType=NUMERIC},
            #{spare.spareCode,jdbcType=VARCHAR},
            #{spare.spareName,jdbcType=VARCHAR},
            #{spare.spareSpec,jdbcType=VARCHAR},
            #{spare.qty,jdbcType=NUMERIC},
            #{spare.money,jdbcType=NUMERIC},
            #{spare.remark,jdbcType=VARCHAR}
            )
        </foreach>
    </insert>
	
	
</mapper>
