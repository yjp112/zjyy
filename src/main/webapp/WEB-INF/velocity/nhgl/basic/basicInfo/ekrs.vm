  <script type="text/javascript">
  $(document).ready(function(){
  	var option7;
	option7 = {
		
		title : {
        	        text: '$!{year}'+'年主会场次数及用电使用情况',
        	        x:'100'
        	    },
        tooltip : {
	        trigger: 'axis',
			formatter:function(params,ticket)
			{
				var str="";
				for(var i=0;i<params.length;i++){
					str = str + params[i][0]+" : "+params[i][2];
					if(params[i][0] == "用电量")
						str = str + " "+electric+"</br>";
					else
						str = str + " " + "次数</br>";
				}
				return str;
				
			}
	    },
		legend: {
			x : 'right',
	        y : 'top',
            data:['用电量','主会场']
        },
        xAxis : [
            {
                type : 'category',
                data : ['1月','2月','3月','4月','5月','6月','7月','8月','9月','10月','11月','12月']
            }
        ],
        yAxis : [
			{
                type : 'value',
                name : '主会场',
                axisLabel : {
                    formatter: '{value} 次数'
                }
            },
            {
                type : 'value',
                name : '用电量',
                axisLabel : {
                    formatter: '{value} kWh'
                }
            }
            
        ],
        series : [
    		{
                name:'用电量',
                type:'bar',
				yAxisIndex: 1,
                data:'$!mapElectric.dataEkrs'.split(',')
            },
            {
                name:'主会场',
                type:'line',
                data:'$!mapElectric.dataEkrsSubjectAmount'.split(',')
            }
        ]
    };
	initEcharts("mix7",option7,function onclickWeek(chart){chart.on('click', eConsole7);});
  });
  function eConsole7(param) {
		$("#subEkrsButton").attr("style","display: block;");
		var value = param.value;
		if(value == '0')
			return;
		var first = param.name;
		var year = $("#year").val();
		var start = $("#start").val();
		console.log(first);
		first = first.substring(0,first.length-1);
		if(first < 10)
			start = year + "-0" + first;
		else
			start = year + "-" + first;
		var url = '';
		url = '$!{rc.contextPath}/basic/basicInfoXin/dayByMonth?start='+start;
		chartMonth(url,start);
	
  	}
  function chartMonth(url,start){
  	var title = "";
    if(start.length == 4)
    	title = start+'主会场次数及用电使用情况';
    else if(start.length == 7)
    	title = start.substring(0,4)+"年"+start.substring(5,7)+'月主会场次数及用电使用情况';
	$.ajax({
           type: "POST",
           url: url,
           data: "code=7",
           success: function(data){
		   		var option10 = {
            		grid:{x:'120px'},
            		title : {
                    	        text: title,
                    	        x:'100'
                    	    },
                    tooltip : {
            	        trigger: 'axis',
            			formatter:function(params,ticket)
            			{
            				var str="";
            				for(var i=0;i<params.length;i++){
            					str = str + params[i][0]+" : "+params[i][2];
            					if(params[i][0] == "用电量")
            						str = str + " "+electric+"</br>";
            					else
            						str = str + " " + "次数</br>";
            				}
            				return str;
            				
            			}
            	    },
            		legend: {
            			x : 'right',
            	        y : 'top',
                        data:['用电量','主会场']
                    },
                    xAxis : [
                        {
                            type : 'category',
                            data : data.dateString.split(',')
                        }
                    ],
                    yAxis : [
            			{
                            type : 'value',
                            name : '主会场',
                            axisLabel : {
                                formatter: '{value} 次数'
                            }
                        },
                        {
                            type : 'value',
                            name : '用电量',
                            axisLabel : {
                                formatter: '{value} kWh'
                            }
                        }
                        
                    ],
                    series : [
                		{
                            name:'用电量',
                            type:'bar',
            				yAxisIndex: 1,
                            data:data.data.split(',')
                        },
                        {
                            name:'主会场',
                            type:'line',
                            data:data.dataSubjectAmount.split(',')
                        }
                    ]
                };
				if(start.length > 4)
					initEcharts("mix7",option10,function onclickWeek(chart){chart.on('click', eConsole71);});
				else
					initEcharts("mix7",option10,function onclickWeek(chart){chart.on('click', eConsole7);});
				$("#ekrsMonth").attr("value",start);
		   }
        });
  }
  function eConsole71(param) {
    	var value = param.value;
    	if(value == '0')
    		return;
    	var first = param.name;
    	var start = $("#ekrsMonth").val();
    	if(first < 10)
    		start = start + "-0" + first;
    	else
    		start = start + "-" + first;
		var title = start.substring(0,4)+"年"+start.substring(5,7)+"月"+start.substring(8,10)+'日主会场及用电使用情况';
    	var url = "";
    	url = '$!{rc.contextPath}/basic/basicInfoXin/hourByDay?start='+start;
    	$.ajax({
           type: "POST",
           url: url,
           data: "code=7",
           success: function(data){
    	   		var option71 = {
            		grid:{x:'120px'},
            		title : {
                    	        text: title,
                    	        x:'100'
                    	    },
                    tooltip : {
            	        trigger: 'axis',
            			formatter:function(params,ticket)
            			{
            				var str="";
            				for(var i=0;i<params.length;i++){
            					str = str + params[i][0]+" : "+params[i][2];
            					if(params[i][0] == "用电量")
            						str = str + " "+electric+"</br>";
            					else
            						str = str + " " + "次数</br>";
            				}
            				return str;
            				
            			}
            	    },
            		legend: {
            			x : 'right',
            	        y : 'top',
                        data:['用电量','主会场']
                    },
                    xAxis : [
                        {
                            type : 'category',
                            data : data.dataHour.split(',')
                        }
                    ],
                    yAxis : [
            			{
                            type : 'value',
                            name : '主会场',
                            axisLabel : {
                                formatter: '{value} 次数'
                            }
                        },
                        {
                            type : 'value',
                            name : '用电量',
                            axisLabel : {
                                formatter: '{value} kWh'
                            }
                        }
                        
                    ],
                    series : [
                		{
                            name:'用电量',
                            type:'bar',
            				yAxisIndex: 1,
                            data:data.data.split(',')
                        },
                        {
                            name:'主会场',
                            type:'line',
                            data:data.dataSubjectAmount.split(',')
                        }
                    ]
                };
    			initEcharts("mix7",option71);
    			$("#ekrsMonth").attr("value",start);
    	   }
        });
		
	}
  function replyEkrs(){
    	var start = $("#ekrsMonth").val();
		
    	if(start.length > 4)
    		start = start.substring(0,start.length-3);
    	var url = "";
    	if(start.length > 4){
    		$("#ekrsMonth").attr("value",start);
			url = '$!{rc.contextPath}/basic/basicInfoXin/dayByMonth?start='+start;
    		chartMonth(url,start);
    	}
    	else{
			$("#ekrsMonth").attr("value",start);
			$("#subEkrsButton").attr("style","display: none;");
			url = '$!{rc.contextPath}/basic/basicInfoXin/monthByYear?start='+start;
    		chartMonth(url,start);
    	}
    }
  </script> 
   