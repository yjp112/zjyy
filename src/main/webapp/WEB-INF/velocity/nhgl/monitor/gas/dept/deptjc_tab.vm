  <style>
  body #centerMain {
	overflow: hidden !important;
	}
  </style> 
  <script type="text/javascript" src="$!{nhgl_static_custom_url}/js/tabs.min.js"> </script>
  
  <SCRIPT type="text/javascript">
	$(document).ready(function(){
    	showProgress("span_dept");
    	showProgress("span_dept_list",38);
    	$('#tab-container').tabs();
	   	$('#qy_accordion_dept').accordion({
            "handle": ".handle",
            "panel": ".panel"
       	});
		$('#tab-containers').tabs();
		var standardCode = '$!{fxCode}';
		if(standardCode != ''){
    		$("a[name='sub']").each(function(){
        		$(this).removeClass();
        	});
			$("#code"+standardCode).attr("class","current");
		}
		var deptId='$!{deptId}';
		if(deptId!=''){
			if($("#qy_accordion_dept #"+deptId).parent().is(".accordion")){
				$("#qy_accordion_dept #"+deptId+" .accordion-opener").click();
			}else{
				$("#qy_accordion_dept #"+deptId).parent().parent("li").addClass("current");
				$("#qy_accordion_dept #"+deptId).parent().removeAttr("style");
				$("#qy_accordion_dept #"+deptId).parent().addClass("open");
				$("#qy_accordion_dept #"+deptId+" a").click();
				$("#qy_accordion_dept #"+deptId).addClass("current");
			}
		}
		
		$("ul.panel li").click(function(){
			$(".panel li").removeClass("current");
			$(this).addClass("current");
		});
		if(deptId==''){
			$("#tabBlock").load('$!{rc.contextPath}/nhgl/monitor/gas/dept/allYear?fxCode='+standardCode+'&eleTotal='+'$!emt.incremental');
		}
    });
  </SCRIPT>
<div class="nh-header">
	<span class="nh-tab-name">蒸汽</span>
	<span class="nh-menu-name">#crumbs("$!menu.code",1)</span>
	<div class="nh-count">
    		<div class="count-item count-item-rise" id="rudD">
			<div class="item-data">
				<span class="data-num fNum2" id="dayTimeEleTotal">$!dayTimeEle.total</span>
				<span>同比昨日</span>
					<span class="data-trend" id="percentD">增长$!dayTimeEle.percent%</span>
			</div>
			<div class="item-ratio">
				<div class="item-ratio-i"></div>
			</div>
			<div class="item-info">
				<span class="info-date">$!sTime</span>
				<span class="info-name" id="deptName1">$!deptName 白天总用蒸汽量</span>
			</div>
		</div>
    		<div class="count-item count-item-rise" id="rudN">
			<div class="item-data">
				<span class="data-num fNum2" id="nightEleTotal">$!nightEle.total</span>
				<span>同比昨日</span>
					<span class="data-trend" id="percentN">增长$!nightEle.percent%</span>
			</div>
			<div class="item-ratio">
				<div class="item-ratio-i"></div>
			</div>
			<div class="item-info">
				<span class="info-date">$!sTime</span>
				<span class="info-name" id="deptName2">$!deptName 夜间总用蒸汽量</span>
			</div>
		</div>
	</div>	
</div>	
<div id="tab-containers" class="nh-box ui-tab ui-tab-h">
	<input id="deptId" type="hidden"/>
	<input id="subId" type="hidden"/>
	<input id="isp" type="hidden"/>
	<input id="name" type="hidden"/>
	<ul class='ui-tab-items ui-tab-items-h'>
       <li class='ui-tab-item'><a href="#tabDept"><span class="ui-tab-area"></span>部门</a></li>
	</ul>
  	<div  class="ui-tab-panels" style="overflow:auto">
		<div id="tabDept" class="ui-tab-panel">
        	<ul id="qy_accordion_dept" class="accordion">
        		#foreach($me in $subTree)
        			#if($me.parentId == $rootId)
        				<li name="subli" id="$me.deptId" isp="1">
        					#if($me.tb==1)
        						<h3 class="handle handle-rise" onclick="toTab('$!me.name','$!me.deptId','1',$!me.total)">
        					#elseif($me.tb==0)
        						<h3 class="handle handle-unchanged" onclick="toTab('$!me.name','$!me.deptId','1',$!me.total)">
        					#else
        						<h3 class="handle handle-decline" onclick="toTab('$!me.name','$!me.deptId','1',$!me.total)">
        					#end
        					    <span class="handle-name" title="$!me.name">$!me.name</span>
        						<span class="handle-num fNum2">$!me.total</span>
        						<span class="handle-bar" name="span_dept" num="$!me.total"></span>
        					</h3>
        					<ul class="panel">
        						#foreach($cm in $subTree)
        							#if($!me.deptId == $!cm.parentId)
        								#if($cm.tb==1)
        									<li name="subli" isp="" id="$cm.deptId" onclick="toTab('$!cm.name','$!cm.deptId','',$!cm.total)" class="pitem-rise">
        								#elseif($cm.tb==0)
        									<li name="subli" isp="" id="$cm.deptId" onclick="toTab('$!cm.name','$!cm.deptId','',$!cm.total)" class="pitem-unchanged">
        								#else
        									<li name="subli" isp="" id="$cm.deptId" onclick="toTab('$!cm.name','$!cm.deptId','',$!cm.total)" class="pitem-decline">
        								#end
        									<a class="pitem-link" href="javascript:;">
        										<span class="pitem-name" title="$!cm.name">$!cm.name</span>
                        						<span class="pitem-num fNum2">$!cm.total</span>
                        						<span class="pitem-bar" name="span_dept_list" num="$!cm.total"></span>
        									</a>
        								</li>
        							#end
        						#end
        					</ul>
        				</li>
        			#end
        		#end
        	</ul>
		</div>
	</div>
</div>
<div class="nh-content">
	<div class="nh-nd">
		<div class="nh-nd-entry">
			<label>分项能耗：</label>
			<ul class="nh-option">
				<li><a href="#" name="sub" id="" class="current" onclick="subTime('')">全部</a></li>
				##这里使用循环遍历出分项
				#foreach($s in $slist)
					#if($s.parentCode == '0')
						<li><a href="#" name="sub" id="code$!{s.standardCode}" onclick="subTime('$!{s.standardCode}')">$s.name</a></li>
					#end
				#end
			</ul>
		</div>
	</div>
	<div id="tabBlock" class="nh-ct">
	</div>
</div>
  
<script type="text/javascript">
	T.nhInit();
	//重新load右边的tab
	var height=$(window).height()-180;
	//$("#qy_accordion_dept").attr("style","height:"+height+"px;overflow:auto;width:350px")
	function toTab(deptName,deptId,isp,eleTotal)
	{	
		$("#deptId").val(deptId);
		var subCode="";
		$("a[name='sub']").each(function(){
    		var aStyle = $(this).attr("class");
    		//如果样式为current，则表示被选中
    		if(aStyle == "current")
    			subCode = $(this).attr("id");
		});
		subCode = subCode.substring(4,subCode.length);
		$("#name").attr("value",deptName);
		var dname=deptName;
		if(deptName.length>8)
			deptName = deptName.substring(0,8)+"...";
		$("#deptName1").text(deptName+" 白天总用蒸汽量");
		$("#deptName2").text(deptName+" 夜间总用蒸汽量");
		var menuCode = '$!menu.code';
		$("#tabBlock").load('$!{rc.contextPath}/nhgl/monitor/gas/dept/allYear?deptName='+encodeURIComponent(dname)+'&deptId='+deptId+'&isp='+isp+'&fxCode='+subCode+'&menuCode='+encodeURIComponent(menuCode));
	}
	function subTime(standardCode){
		var deptId=$("#deptId").val();
		var name = $("#name").val();
		var menuCode = '$!menu.code';
		$("#chart_content_id").load('$!{rc.contextPath}/nhgl/monitor/gas/dept/deptindex?fxCode='+standardCode+'&deptId='+deptId+'&menuCode='+encodeURIComponent(menuCode));
	}
</script>