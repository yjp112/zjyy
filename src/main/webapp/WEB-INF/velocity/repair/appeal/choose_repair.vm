#parse("index/_header.vm")
</head>
<body style="padding-bottom:40px;">
#parse("index/_footer.vm")  
<script type="text/javascript">
	$(document).ready(function(){
		 _iframe_layout = $('body').layout({
	      defaults: {
	        resizable: true,
	        closable: false,
	        spacing_open: 5
	      }
	    });
	});
	
    var setting = {
	data: {
		simpleData: {enable: true}
      },
      callback: {
			onClick: function(event, treeId, treeNode) {
				
			if("$!{dialogId}"!=""){
	        		get_el_in_dialog("$!{dialogId}","#$!{txtId}").val(treeNode.id);
	        		get_el_in_dialog("$!{dialogId}","#$!{txtName}").val(treeNode.name);  
	        		resetfocus(get_el_in_dialog("$!{dialogId}","#$!{txtName}"));
            	}else{
					var id_v = $("#"+"$!{txtId}",window.parent["_main_frame"].document);
					id_v.val(treeNode.id);
				//	alert(treeNode.id);
				//	alert(treeNode.name);
					window.parent[1].document.getElementById("parentId").value = treeNode.id;
					window.parent[1].document.getElementById("parentName").value = treeNode.name;
					var parentid = window.parent[0].document.getElementById("parentId");
					
					var id_t = $("#"+"$!{txtName}",window.parent["_main_frame"].document);
					id_t.val(treeNode.name);
					resetfocus($("#"+"$!{txtName}",window.parent["_main_frame"].document));
				}
				//关闭iframe
				close_dialog('choose_dept');
				
    			//window.close();
			}
		}
    };
    var zNodes = [];    
	zNodes.push({id:"0", pId:"-1", name:"维修类别簇",open:true});  
    #foreach($!{treeNode} in $!{treeList})
	        zNodes.push({id:$!{treeNode.id}, pId:$!{treeNode.parentId}, name:"$!{treeNode.categoryName}"}); 
    #end
   $(document).ready(function(){
		$.fn.zTree.init($("#treeDemo_choose"), setting,zNodes).expandAll(true);
    });
	
	function resetfocus(obj){
	$(obj).focus();
    $(obj).blur();
}
    
    function clearChoose(){
			window.parent[1].document.getElementById("parentId").value = "";
			window.parent[1].document.getElementById("parentName").value = "";
  		    var id_v = $("#"+"$!{txtId}",window.parent["_main_frame"].document);
			id_v.val("");
			var id_t = $("#"+"$!{txtName}",window.parent["_main_frame"].document);
			id_t.val("");
			resetfocus($("#"+"$!{txtName}",window.parent["_main_frame"].document));
    	
		//关闭iframe
		close_dialog('choose_dept');
		return true;
    }
</script>

<div class="ui-layout-center ui-dialog-form">
	<div class="tree">
		<ul id="treeDemo_choose" class="ztree"></ul>   
	</div>
	<div class="actions">
		<button class="hc_btn cancel" onclick="clearChoose()" type="button"><i class="fa fa-close"></i>清空</button>
	</div>
</div>
  </body>
</html>

