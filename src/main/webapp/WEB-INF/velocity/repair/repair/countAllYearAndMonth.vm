<style>
	.north-charts {
		position: relative;
	}
	#subButton {
		position: absolute;
		top: 0;
		left: 10px;
		z-index: 2;
	}
</style>
  <div class="ui-layout-north" class="north-charts">	
		<div id="subButton" style="display:none">
            	<button type="button" onclick="reply()" class="hc_btn k-button k-primary"><i class="iconfont icon-reply"></i>&nbsp;&nbsp;返回</button>
             </div>
    	<div id="spareCharts" style="height:300px">			
    	</div>
   </div>
<script src="$!{main_static_custom_url}/js/echarts/echarts.js"></script>
<script type="text/javascript">
//加载chart
function initEcharts(divId, option,callbackFun ,theme) {
    	if(typeof theme =="undefined"){
            theme = "custom_dark";
        }
		require.config({
        	packages: [
                {
                    name: 'echarts',
                    location: '$!{main_static_custom_url}/js/echarts',
                    main: 'echarts'
                }
            ]
        });
        require(
            [
                'echarts',
                'echarts/chart/line',
                'echarts/chart/bar'
            ],
            function (echarts, defaultTheme) {
                chart = echarts.init(document.getElementById(divId), defaultTheme);
                chart.setOption(option, true);
                if(callbackFun){
                	callbackFun(chart,option);
                }
            }
        );
	}

        var option = {
        	title:{
        		text:'$!{title}',
        		x:'center'
        	},
		    tooltip : {
		        trigger: 'axis'
		    },
		    legend: {
		        data:['报修工单数','完成维修工单数'],
		        x:'right',
		    	y:'top'
		    },
		    xAxis : [
		        {
		            type : 'category',
		            data : '$!{xTime}'.split(",")
		        }
		    ],
		    yAxis : [
		        {
		            type : 'value',
		            name : '报修工单数(个)',
		            axisLabel : {
		                formatter: '{value} '
		            }
		        },
		        {
		            type : 'value',
		            name : '完成维修工单数(个)',
		            axisLabel : {
		                formatter: '{value} '
		            }
		        }
		    ],
		    series : [
		
		        {
		            name:'报修工单数',
		            type:'bar',
		            data:'$!{nums}'.split(",")
		        },
		        {
		            name:'完成维修工单数',
		            type:'bar',
		            data:'$!{finishNums}'.split(",")
		        }
		    ]
        };
	
	initEcharts("spareCharts",option,function onclickMonth(chart){chart.on('click', eConsole);});
	
	function eConsole(param) {
		var month = param.name.split(" ")[0];
		if(month.length == 7){
			$.ajax({
               type: "POST",
               url: '$!{rc.contextPath}/repair/repairReport/countAllMonth?month='+month,
               success: function(responseText){
    			   chart.clear();
				   $("#subButton").css("display","block");
    			   $("#spareCharts").html(responseText);
    		   }
        	});
		}
	}
	
	function reply(){
		var year = $("#repairYear").val();
		$.ajax({
               type: "POST",
               url: '$!{rc.contextPath}/repair/repairReport/countAllYear?year='+year,
               success: function(responseText){
    			   chart.clear();
				   $("#subButton").css("display","none");
    			   $("#spareCharts").html(responseText);
    		   }
        });
	}
	
</script>
