#parse("index/_header.vm")
</head>
<body>	
    	<div class="ui-layout-center">
  			<ul id="dutyGroupTree" class="ztree"></ul>
    	</div>
    	<div class="ui-dialog-form">
			<div class="actions">
				<button class="hc_btn cancel" onclick="clearChoose()" type="button">清空</button>
			</div>
		</div>
<script type="text/javascript">
    var setting = {
	data: {
		simpleData: {enable: true}
      },
      callback: {
			onClick: function(event, treeId, treeNode) {
                if(treeNode.id=="$!id"){
                    notify("不能选择自己当类型", "warn");
                }else{
                    get_el_in_dialog("$!{dialogId}","#"+"$!{txtId}").val(treeNode.id);
                    get_el_in_dialog("$!{dialogId}","#"+"$!{txtName}").val(treeNode.name);
                    resetfocus(get_el_in_dialog("$!{dialogId}","#"+"$!{txtName}").val(treeNode.name));
                    //$("#"+"$!{txtId}").val(treeNode.id);
                    //$("#"+"$!{txtName}").val(treeNode.name);
                    close_dialog('selectDiloag');
                }

			}
		}
    };
	var zNodes = [];  
	zNodes.push({id:"0", pId:"-1", name:"值班班组",url:"",target:""});   
	#foreach($!{treeNode} in $!{dutyGroup_tree})
		if($!{treeNode.parentId} == 0)
    	zNodes.push({id:$!{treeNode.id}, pId:$!{treeNode.parentId}, name:"$!{treeNode.groupName}",url:"",target:""});     
	#end
	
	$(document).ready(function(){
		$.fn.zTree.init($("#dutyGroupTree"), setting,zNodes).expandAll(true);
	});
	
	function okClick(){
    	var zTree = $.fn.zTree.getZTreeObj("dutyGroupTree");
    	var nodes=zTree.getCheckedNodes(true);
    	if (nodes.length == 0) {
            notify("未选择", "warn");
		   return false;
    	}else{
    		if (parent){
    			$("#"+"$!{txtId}").val(nodes[0].id);
    			$("#"+"$!{txtName}").val(nodes[0].name); 
    		}
    		
    	}
		return true;
	}
	
	function clearChoose(){
    	if("$!{dialogId}"!=""){
    		get_el_in_dialog("$!{dialogId}","#$!{txtId}").val("");
    		get_el_in_dialog("$!{dialogId}","#$!{txtName}").val("");
    		resetfocus(get_el_in_dialog("$!{dialogId}","#"+"$!{txtName}").val(""));
    	}else{
			var id_v = $("#"+"$!{txtId}",window.parent["_main_frame"].document);
			id_v.val("");
			var id_t = $("#"+"$!{txtName}",window.parent["_main_frame"].document);
			id_t.val("");
			resetfocus($("#"+"$!{txtName}",window.parent["_main_frame"].document));
		}
		//关闭iframe
		close_dialog('selectDiloag');
		return true;
    }

</script>
</body>
</html>
 
 