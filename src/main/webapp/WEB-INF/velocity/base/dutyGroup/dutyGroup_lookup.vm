#parse("index/_header.vm")
</head>
<body>	
    	<div class="ui-layout-center">
  			<ul id="dutyGroupTree" class="ztree"></ul>
    	</div>
    	<div class="ui-dialog-form">
			<div class="actions">
				#if(!$!{type})
				<button class="hc_btn cancel" onclick="clearChoose()" type="button">清空</button>
				#end
			</div>
		</div>
<script type="text/javascript">
    var setting = {
	data: {
		simpleData: {enable: true}
      },
      callback: {
			onClick: function(event, treeId, treeNode) {
				if(treeNode.pId=='0'){
				 notify("请选择班组！", "warn");
				  return false;
				}
				if('$!{dialogId}'!='' && get_el_in_dialog("$!{dialogId}","#"+"$!{txtId}") && get_el_in_dialog("$!{dialogId}","#"+"$!{txtName}")){
                    get_el_in_dialog("$!{dialogId}","#"+"$!{txtId}").val(treeNode.id);
					get_el_in_dialog("$!{dialogId}","#"+"$!{txtName}").val(treeNode.name);
					resetfocus(get_el_in_dialog("$!{dialogId}","#"+"$!{txtName}").val(treeNode.name));
                    get_el_in_dialog("$!{dialogId}","#personId_id").val("");
                    get_el_in_dialog("$!{dialogId}","#personName_id").val("");
				}else{
					var id_v = $("#"+"$!{txtId}",window.parent["_main_frame"].document);
        			id_v.val(treeNode.id);
        			var id_t = $("#"+"$!{txtName}",window.parent["_main_frame"].document);
        			id_t.val(treeNode.name);
					resetfocus($("#"+"$!{txtName}",window.parent["_main_frame"].document));
                  if("$!{user}")
					    $("#"+"$!{user}",window.parent["_main_frame"].document).val("");
					var type='$!{type}';
					if(type=='01'){
						$("#"+"$!{telphone}",window.parent["_main_frame"].document).val("");
						$("#"+"$!{handlePersonCode}",window.parent["_main_frame"].document).val("");
						$("#"+"$!{userId}",window.parent["_main_frame"].document).val("");
					}
				}
				
				close_dialog('selectDiloag');
			}
		}
    };
	var zNodes = [];  
	zNodes.push({id:"0", pId:"-1", name:"值班班组",url:"",target:""});   
	#foreach($!{treeNode} in $!{dutyGroup_tree})
    	zNodes.push({id:$!{treeNode.id}, pId:$!{treeNode.parentId}, name:"$!{treeNode.groupName}",url:"",target:""});     
	#end
 	$(document).ready(function(){
  		$.fn.zTree.init($("#dutyGroupTree"), setting,zNodes).expandAll(true);
  	});

	function clearChoose(){
    	if("$!{dialogId}"!=""){
    		get_el_in_dialog("$!{dialogId}","#$!{txtId}").val("");
    		get_el_in_dialog("$!{dialogId}","#$!{txtName}").val("");  
    		resetfocus(get_el_in_dialog("$!{dialogId}","#"+"$!{txtName}").val(""));
    	}else{
			var id_v = $("#"+"$!{txtId}",window.parent["_main_frame"].document);
			id_v.val("");
			var id_t = $("#"+"$!{txtName}",window.parent["_main_frame"].document);
			id_t.val("");
			resetfocus($("#"+"$!{txtName}",window.parent["_main_frame"].document));
		}
		//关闭iframe
		close_dialog('selectDiloag');
		return true;
    }
</script>
</body>
</html>
 
 