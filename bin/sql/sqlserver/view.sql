
/****** Object:  View [dbo].[VIEW_NH_ELECTRIC_METER]    Script Date: 08/21/2015 13:42:24 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VIEW_NH_ELECTRIC_METER]'))
DROP VIEW [dbo].[VIEW_NH_ELECTRIC_METER]
GO

/****** Object:  View [dbo].[VIEW_NH_ENERGY_METER]    Script Date: 08/21/2015 13:42:24 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VIEW_NH_ENERGY_METER]'))
DROP VIEW [dbo].[VIEW_NH_ENERGY_METER]
GO

/****** Object:  View [dbo].[VIEW_NH_GAS_METER]    Script Date: 08/21/2015 13:42:24 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VIEW_NH_GAS_METER]'))
DROP VIEW [dbo].[VIEW_NH_GAS_METER]
GO

/****** Object:  View [dbo].[VIEW_NH_WATER_METER]    Script Date: 08/21/2015 13:42:24 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[VIEW_NH_WATER_METER]'))
DROP VIEW [dbo].[VIEW_NH_WATER_METER]
GO


/****** Object:  View [dbo].[VIEW_NH_ELECTRIC_METER]    Script Date: 08/21/2015 13:42:24 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[VIEW_NH_ELECTRIC_METER] AS (
	SELECT
		BIT_NO,
		ISNULL(TOTAL - INCREMENTAL, 0) LAST_TOTAL,
		TOTAL,
		INCREMENTAL,
		COLLECT_TIME
	FROM
		NH_ELECTRIC_METER
	UNION ALL
		SELECT
			BIT_NO,
			ISNULL(TOTAL - INCREMENTAL, 0) LAST_TOTAL,
			TOTAL,
			INCREMENTAL,
			COLLECT_TIME
		FROM
			NH_ELECTRIC_METER_TOTAL
)

GO

/****** Object:  View [dbo].[VIEW_NH_ENERGY_METER]    Script Date: 08/21/2015 13:42:24 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[VIEW_NH_ENERGY_METER] AS 
(
	SELECT
		BIT_NO,
		ISNULL(TOTAL - INCREMENTAL, 0) LAST_TOTAL,
		TOTAL,
		INCREMENTAL,
		COLLECT_TIME
	FROM
		NH_ENERGY_METER
	UNION ALL
		SELECT
			BIT_NO,
			ISNULL(TOTAL - INCREMENTAL, 0) LAST_TOTAL,
			TOTAL,
			INCREMENTAL,
			COLLECT_TIME
		FROM
			NH_ENERGY_METER_TOTAL
)
GO

/****** Object:  View [dbo].[VIEW_NH_GAS_METER]    Script Date: 08/21/2015 13:42:24 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[VIEW_NH_GAS_METER] AS 
(
	SELECT
		BIT_NO,
		ISNULL(TOTAL - INCREMENTAL, 0) LAST_TOTAL,
		TOTAL,
		INCREMENTAL,
		COLLECT_TIME
	FROM
		NH_GAS_METER
	UNION ALL
		SELECT
			BIT_NO,
			ISNULL(TOTAL - INCREMENTAL, 0) LAST_TOTAL,
			TOTAL,
			INCREMENTAL,
			COLLECT_TIME
		FROM
			NH_GAS_METER_TOTAL
)
GO

/****** Object:  View [dbo].[VIEW_NH_WATER_METER]    Script Date: 08/21/2015 13:42:24 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[VIEW_NH_WATER_METER] AS 
(
	SELECT
		BIT_NO,
		ISNULL(TOTAL - INCREMENTAL, 0) LAST_TOTAL,
		TOTAL,
		INCREMENTAL,
		COLLECT_TIME
	FROM
		NH_WATER_METER
	UNION ALL
		SELECT
			BIT_NO,
			ISNULL(TOTAL - INCREMENTAL, 0) LAST_TOTAL,
			TOTAL,
			INCREMENTAL,
			COLLECT_TIME
		FROM
			NH_WATER_METER_TOTAL
)
GO

